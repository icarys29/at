Deliver Workflow Swimlane (at) â€” /at:run
Date: 2026-02-01

Columns:
  USER        ORCHESTRATOR (/at:run)         SCRIPTS (uv run)                          AGENTS (Task)                 HOOKS (Claude Code)                REPO/ARTIFACTS

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  request  -> parse args
              |
              +-- if --rollback -------------------------> restore_checkpoint.py                                                                                -> SESSION_DIR/checkpoints/<cp>/RESTORE_REPORT.md
              |                                                                                                                          (stop)
              |
              +-- if --from-phase/--gate ----------------> workflow/run_deterministic.py                                                                          -> SESSION_DIR/status/deterministic_run_report.{json,md}
              |                                                                                                                          (stop)
              |
              +-- create/resume session -----------------> session/create_session.py                                                                               -> SESSION_DIR/** + SESSION_DIR/session.json
              |                                                                                                                           -> sessions_root/.at_active_session.json
              |                                                                                                                           -> sessions_root/.at_session_links.json
              |
              +-- Write request.md -------------------------------------------------------------------------------------------------------------------------------> SESSION_DIR/inputs/request.md
              |
              +-- build context pack --------------------> context/build_context_pack.py                                                                           -> SESSION_DIR/inputs/context_pack.md
              |
              +-- plan (agentic) ---------------------------------------------------------------> action-planner -------------------------------------------------> SESSION_DIR/planning/actions.json
              |                                                                                   (writes checklists)                                              -> SESSION_DIR/planning/REQUIREMENT_TRACEABILITY_MATRIX.md
              |                                                                                                                                        -> SESSION_DIR/planning/VERIFICATION_CHECKLIST.md
              |                                                                                                  +-- (H) PostToolUse (Write actions.json) ---------> hooks/validate_actions_write.py (blocks invalid plan)
              |
              +-- validate plan -------------------------> validate/validate_actions.py                                                                            -> (exit 0/1; errors to stderr)
              |
              +-- build per-task contexts ---------------> context/build_task_contexts.py                                                                           -> SESSION_DIR/inputs/task_context/<task_id>.md
              |                                                                                                                                        -> SESSION_DIR/inputs/task_context_manifest.json
              |                                                                                                                                        -> (optional) embeds context.code_pointers excerpts
              |
              +-- checkpoint ----------------------------> checkpoint/create_checkpoint.py                                                                           -> SESSION_DIR/checkpoints/cp-###/*
              |
              +-- execute planned tasks (parallel by default)
              |       +---------------------------------------------------------------> implementor / tests-builder ------------------------------------------> implementation/tasks/<task_id>.yaml
              |       |                                                                                                                        -> testing/tasks/<task_id>.yaml
              |       |
              |       +-- (H) PreToolUse (Write/Edit) -------------------------------------------> hooks/enforce_file_scope.py (deny out-of-scope writes)
              |       |
              |       +-- (H) SubagentStop ------------------------------------------------------> hooks/on_subagent_stop.py (enforce final reply contract + artifacts)
              |
              +-- deterministic gates ------------------> validate/validate_task_artifacts.py                                                                        -> quality/task_artifacts_report.{json,md}
              |                                         -> validate/plan_adherence.py                                                                               -> quality/plan_adherence_report.{json,md}
              |                                         -> validate/parallel_conformance.py                                                                         -> quality/parallel_conformance_report.{json,md}
              |                                         -> quality/run_quality_suite.py                                                                             -> quality/quality_report.{json,md}
              |                                                                                                                                        -> quality/command_logs/*.log
              |                                         -> (agentic docs, always-on) -------------------------------------------------------> docs-keeper --------------> repo docs updated under docs/*
              |                                         -> docs/generate_registry_md.py                                                                             -> docs/DOCUMENTATION_REGISTRY.md
              |                                         -> validate/docs_gate.py                                                                                    -> documentation/docs_summary.{json,md}
              |                                                                                                                                        -> documentation/docs_gate_report.{json,md}
              |                                         -> validate/validate_changed_files.py                                                                       -> quality/changed_files_report.{json,md}
              |                                         -> compliance/generate_compliance_report.py                                                                 -> compliance/compliance_report.json
              |                                                                                                                                        -> compliance/COMPLIANCE_VERIFICATION_REPORT.md
              |
              +-- (optional) narrative compliance -----------------------------------------------> compliance-checker (optional narrative only)
              |
              +-- update progress ----------------------> session/session_progress.py                                                                               -> status/session_progress.{json,md}
              |
  read results <------------------------------------ report key artifacts + next actions

Notes:
  - All deterministic evidence lives under SESSION_DIR (session-backed, reproducible).
  - Policy/audit/learning hooks are opt-in and run outside this core swimlane when installed.
