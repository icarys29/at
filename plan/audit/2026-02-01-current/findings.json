{
  "version": 1,
  "generated_at": "2026-02-01",
  "plugin": {
    "name": "at",
    "version": "0.1.0"
  },
  "findings": [
    {
      "id": "F-01",
      "severity": "critical",
      "area": "scope_enforcement",
      "title": "Scope enforcement hook can fail open when session/task inference fails",
      "evidence": [
        "scripts/hooks/enforce_file_scope.py",
        "hooks/hooks.json"
      ],
      "risk": "Out-of-scope writes may not be blocked at tool-time, undermining safe parallelism and plan adherence.",
      "recommendations": [
        "Prefer hook input session_id (and other hook fields) over transcript parsing when resolving the session context.",
        "If task_id cannot be resolved, consider fail-closed outside SESSION_DIR (deny writes to non-session paths) or emit a loud warning and log the failure.",
        "Add a deterministic self-audit/integration test that simulates hook inputs and asserts enforcement behavior."
      ]
    },
    {
      "id": "F-02",
      "severity": "high",
      "area": "subagent_contracts",
      "title": "SubagentStop contract validation can fail open due to transcript-based session inference",
      "evidence": [
        "scripts/hooks/on_subagent_stop.py",
        "hooks/hooks.json"
      ],
      "risk": "Missing or malformed final reply contracts and artifacts may not be detected in some cases.",
      "recommendations": [
        "Resolve SESSION_DIR via hook input session_id where possible, and only fall back to transcript scanning when necessary.",
        "Optionally scope enforcement to known at agent ids (payload.agent) to avoid false positives and to ensure expected enforcement."
      ]
    },
    {
      "id": "F-03",
      "severity": "high",
      "area": "contracts",
      "title": "Risk of drift between JSON Schemas and bespoke validators",
      "evidence": [
        "schemas/actions.schema.json",
        "scripts/validate/actions_validator.py",
        "plan/audit/previous_plugin_lessons_report.md"
      ],
      "risk": "Contract drift can reintroduce non-determinism and workflow brittleness; the prior plugin audit flagged drift as a major reliability issue.",
      "recommendations": [
        "Choose a single source of truth (schema-as-truth or validator-as-truth) and align the other artifact accordingly.",
        "Add deterministic fixtures and a script to ensure schema and validator accept/reject the same representative examples."
      ]
    },
    {
      "id": "F-04",
      "severity": "medium",
      "area": "gates",
      "title": "Compliance decision is mostly deterministic but implemented as an agent",
      "evidence": [
        "agents/compliance-checker.md",
        "scripts/validate/validate_changed_files.py"
      ],
      "risk": "Unnecessary variability and harder regression testing for a primarily mechanical decision.",
      "recommendations": [
        "Implement compliance as a deterministic script that writes the report (and optionally JSON).",
        "Keep an optional agent for narrative explanation only, if desired."
      ]
    },
    {
      "id": "F-05",
      "severity": "medium",
      "area": "versioning",
      "title": "Skill files do not appear to follow the stated per-file version metadata discipline",
      "evidence": [
        "CLAUDE.md",
        "skills/*/SKILL.md"
      ],
      "risk": "Upgrades and diffs become harder to audit consistently if only some artifacts are stamped with version/updated metadata.",
      "recommendations": [
        "Add version/updated fields to skill frontmatter, or adjust CLAUDE.md to document the intended scope of version stamping."
      ]
    },
    {
      "id": "F-06",
      "severity": "medium",
      "area": "orchestration",
      "title": "/at:run is prose-based orchestration; resume/rerun behavior is hard to regression test",
      "evidence": [
        "skills/run/SKILL.md",
        "plan/audit/upstream/PLUGIN_AUDIT_2026-01-25.md"
      ],
      "risk": "Model interpretation drift can break sequencing, especially around resume/rerun semantics and remediation loops.",
      "recommendations": [
        "Add a small deterministic state/progress engine that computes the next step(s) from on-disk artifacts and supports --from-phase and rerun-gate operations."
      ]
    },
    {
      "id": "F-07",
      "severity": "low",
      "area": "scope_control",
      "title": "P3 features exist in v0.1.0; risk of premature surface-area growth",
      "evidence": [
        "scripts/audit/*",
        "scripts/learning/*",
        "scripts/telemetry/*",
        "scripts/project_pack/*",
        "scripts/upgrade/*",
        "skills/setup-audit-hooks/SKILL.md",
        "skills/setup-learning-hooks/SKILL.md",
        "skills/telemetry-session-kpis/SKILL.md",
        "skills/install-project-pack/SKILL.md",
        "skills/upgrade-project/SKILL.md"
      ],
      "risk": "Core stability can suffer if optional modules evolve without clear boundaries and release discipline.",
      "recommendations": [
        "Keep optional subsystems opt-in (current state is good).",
        "Document a clear 'core vs optional packs' boundary and stabilize core workflows before expanding optional subsystems."
      ]
    },
    {
      "id": "F-08",
      "severity": "high",
      "area": "documentation",
      "title": "Documentation updates were not explicitly part of deliver; registry lacked planner-actionable selection metadata",
      "evidence": [
        "skills/run/SKILL.md",
        "agents/docs-keeper.md",
        "scripts/validate/docs_gate.py",
        "scripts/docs/generate_registry_md.py",
        "docs/DOCUMENTATION_REGISTRY.json",
        "docs/DOCUMENTATION_REGISTRY.md"
      ],
      "risk": "Docs drift from delivered changes and planners cannot reliably decide which docs to embed in task contexts, leading to inconsistent behavior and low trust in documentation.",
      "recommendations": [
        "Run docs updates as an always-on deliver step (docs-keeper) before the docs gate.",
        "Require each registry entry to include a short 'when' field (1â€“2 sentences) to guide planner context selection; optionally include tags.",
        "Generate the registry Markdown view from JSON and enforce drift deterministically in the docs gate.",
        "Include registry 'when' and tags in the context pack summary so planners can select doc_ids without opening every document."
      ]
    }
  ]
}
